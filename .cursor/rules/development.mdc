---
title: "코딩 규칙"
description: "StockAlert 프로젝트의 코딩 규칙, 명명 규칙, 파일 구조 및 상태 관리"
---

# 코딩 규칙

## 명명 규칙
- **변수/함수**: camelCase (`getStockPrice`, `userSubscription`)
- **컴포넌트**: PascalCase (`StockCard`, `ConditionForm`)
- **상수**: UPPER_SNAKE_CASE (`MAX_CONDITIONS`, `DEFAULT_REFRESH_TIME`)
- **파일명**: kebab-case (`stock-card.tsx`, `condition-form.tsx`)
- **데이터베이스**: snake_case (`stock_subscriptions`, `alert_conditions`)

## 컴포넌트 구조
```typescript
interface StockCardProps {
  stockCode: string;
  stockName: string;
  currentPrice: number;
  changeRate: number;
}

export function StockCard({ stockCode, stockName, currentPrice, changeRate }: StockCardProps) {
  return (
    // JSX 반환
  );
}
```

## 파일 구조
```
/src
  /components          # 재사용 가능한 UI 컴포넌트
    /ui               # shadcn/ui 기본 컴포넌트
    /stock            # 주식 관련 컴포넌트
    /condition        # 조건 관련 컴포넌트
    /auth             # 인증 관련 컴포넌트
  /app                # Next.js App Router
    /api              # API Routes
  /lib                # 유틸리티 함수 및 설정
    /supabase         # Supabase 클라이언트 및 설정
    /validations      # 데이터 검증 스키마
  /types              # TypeScript 타입 정의
    /database         # 데이터베이스 타입 정의
  /hooks              # 커스텀 React 훅
    /supabase         # Supabase 관련 훅
  /constants          # 상수 정의
```

## Supabase 연동 규칙
- **MCP 도구 필수 사용**: 모든 DB 작업에 Supabase MCP 도구 사용 (`mcp_supabase_execute_sql`, `mcp_supabase_apply_migration`)
- **실시간 모니터링**: `mcp_supabase_get_logs`로 로그 확인, `mcp_supabase_get_advisors`로 보안 점검
- **타입 자동 생성**: `mcp_supabase_generate_typescript_types`로 최신 타입 생성
- **Edge Functions**: `mcp_supabase_deploy_edge_function`으로 서버리스 함수 배포
- **Row Level Security**: 모든 테이블에 RLS 정책 적용
- **배치 처리**: Supabase Scheduled Functions를 통한 정기적 주가 조회
- **에러 처리**: Supabase 에러를 사용자 친화적 메시지로 변환

## API 연동 개발 규칙
- **실시간 데이터**: 네이버 주식 API와 Supabase DB 직접 연동 필수
- **데이터 동기화**: API 응답을 Supabase 테이블에 실시간 저장
- **CRUD 구현**: 모든 주식 구독, 알림 조건, 알림 히스토리 CRUD 작업 구현
- **트랜잭션 처리**: 데이터 일관성을 위한 트랜잭션 사용
- **에러 복구**: API 실패 시 재시도 로직 및 폴백 처리

## 상태 관리
- **useState**: 간단한 로컬 상태
- **useReducer**: 복잡한 상태 로직
- **Context API**: 전역 상태 (필요시)
- **커스텀 훅**: 재사용 가능한 상태 로직
- **Supabase 데이터**: 일반적인 CRUD 작업을 통한 데이터 관리

## API 설계
- **RESTful API**: Next.js API Routes 활용
- **타입 안전성**: Supabase 생성 타입 활용
- **에러 핸들링**: 일관된 에러 응답 형식
- **인증**: Supabase Auth 토큰 검증

## 에러 처리
- **사용자 친화적**: 기술적 에러를 사용자가 이해할 수 있는 메시지로 변환
- **입력 검증**: Zod를 활용한 스키마 검증
- **타입 검증**: TypeScript를 활용한 컴파일 타임 검증
- **Supabase 에러**: 데이터베이스 에러를 적절히 처리